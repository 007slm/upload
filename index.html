<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>iframe-uploader</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
        <meta name="author" content="lepture" />
        <link rel="alternate" type="application/rss+xml" href="http://feeds.lepture.com/lepture" title="Website Feed" />
        <link rel="stylesheet" href="http://python-assets.b0.upaiyun.com/project/typo.css" />
        <link rel="stylesheet" href="http://python-assets.b0.upaiyun.com/project/pygments.css" />
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-21475122-1']);
            _gaq.push(['_trackPageview']);
            _gaq.push(['_trackPageLoadTime']);
            _gaq.push(['_setCustomVar', 1, 'Project', 'iframe-uploader', 2]);
            (function() {
             var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
             ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
             var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
             })();
        </script>
    </head>
    <body>
        <div class="container">
            <h1>iframe uploader</h1>

<p>The fake-ajax file uploader. Seajs compatible.</p>

<p><strong>Required Library</strong>: jQuery</p>

<h2>DEMO</h2>

<p>The server script is written in Python. If you are not familiar with Python,
but you are on Linux or Mac, that could be easy.</p>

<p>First may sure you have installed <a href="http://tornadoweb.org">tornado</a>:</p>
<div class="highlight"><pre><span class="nx">pip</span> <span class="nx">install</span> <span class="nx">tornado</span>
</pre></div>

<p>If pip doesn&#39;t work, try:</p>
<div class="highlight"><pre><span class="nx">easy_install</span> <span class="nx">tornado</span>
</pre></div>

<h3>Start server with:</h3>
<div class="highlight"><pre><span class="nx">python</span> <span class="nx">server</span><span class="p">.</span><span class="nx">py</span>
</pre></div>

<p>Now open your browser: <code>http://127.0.0.1:8888</code>. Have a try!</p>

<h2>API</h2>

<p>Create a uploader:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">uploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IframeUploader</span><span class="p">({</span>
    <span class="nx">trigger</span><span class="o">:</span> <span class="s1">&#39;#upload-icon&#39;</span><span class="p">,</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span>
    <span class="nx">action</span><span class="o">:</span> <span class="s1">&#39;/upload&#39;</span><span class="p">,</span>
    <span class="nx">accept</span><span class="o">:</span> <span class="s1">&#39;image/*&#39;</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;xsrf&#39;</span><span class="o">:</span> <span class="s1">&#39;hash&#39;</span><span class="p">},</span>
    <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<ul>
<li>trigger: a valid jQuery selector</li>
<li>name: name of the file input. for example &#39;file&#39;, &#39;image&#39;.</li>
<li>action: form&#39;s action. Where to post your file.</li>
<li>accept: file input accept attribute</li>
<li>data: extra data that you want to post, for example &#39;xsrf&#39;</li>
<li>success: success callback</li>
</ul>

<p>Chain style:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">uploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IframeUploader</span><span class="p">({</span>
    <span class="nx">trigger</span><span class="o">:</span> <span class="s1">&#39;#upload-icon&#39;</span><span class="p">,</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span>
    <span class="nx">action</span><span class="o">:</span> <span class="s1">&#39;/upload&#39;</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;xsrf&#39;</span><span class="o">:</span> <span class="s1">&#39;hash&#39;</span><span class="p">}</span>
<span class="p">}).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p>data api support</p>
<div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">&quot;upload&quot;</span> <span class="na">data-name=</span><span class="s">&quot;image&quot;</span> <span class="na">data-action=</span><span class="s">&quot;/upload&quot;</span> <span class="na">data-data=</span><span class="s">&quot;a=a&amp;b=b&quot;</span><span class="nt">&gt;</span>Upload<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">uploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IframeUploader</span><span class="p">({</span><span class="s1">&#39;trigger&#39;</span><span class="o">:</span> <span class="s1">&#39;#upload&#39;</span><span class="p">});</span>
<span class="nx">uploader</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>

<h2>Advanced</h2>

<p>Demo in <strong>API</strong> section could not be controlled. When you select a file, it will
be submitted immediately. We can broke the chain with <code>change</code>:</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">uploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IframeUploader</span><span class="p">({</span>
    <span class="nx">trigger</span><span class="o">:</span> <span class="s1">&#39;#upload-icon&#39;</span><span class="p">,</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span>
    <span class="nx">action</span><span class="o">:</span> <span class="s1">&#39;/upload&#39;</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;xsrf&#39;</span><span class="o">:</span> <span class="s1">&#39;hash&#39;</span><span class="p">}</span>
<span class="p">}).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">filename</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;you are selecting &#39;</span> <span class="o">+</span> <span class="nx">filename</span><span class="p">);</span>
    <span class="c1">// Default behavior of change is</span>
    <span class="c1">// this.submit();</span>
<span class="p">}).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p>Now you should handle it yourself:</p>
<div class="highlight"><pre><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#submit&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">uploader</span><span class="p">.</span><span class="nx">submit</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>

<h2>Seajs Hint</h2>

<p>Load iframe uploader with seajs:</p>
<div class="highlight"><pre><span class="nx">seajs</span><span class="p">.</span><span class="nx">use</span><span class="p">([</span><span class="s1">&#39;./iframe-uploader&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">IframeUploader</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">uploader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IframeUploader</span><span class="p">({</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

        </div>
        <hr class="end" />
        <div id="footer">
            <a href="https://github.com/lepture">GitHub</a>
            <a href="http://lepture.com">Website</a>
            <a href="https://twitter.com/lepture">Twitter</a>
        </div>
        <a id="github" href="https://github.com/lepture/iframe-uploader" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0; z-index:999" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
    </body>
</html>

